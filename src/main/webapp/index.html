<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="https://unpkg.com/purecss@2.1.0/build/pure-min.css"
          integrity="sha384-yHIFVG6ClnONEA5yB5DJXfW2/KC173DIQrYoZMEtBvGzmf0PKiGyNEqe9N6BNDBH" crossorigin="anonymous">
</head>
<body>
<div style="text-align: center;">
    <h1>Insert location data:</h1>
    <form id="welcome" class="pure-form pure-form-aligned">
        <fieldset>
            <div class="pure-control-group">
                <label>City:</label>
                <input type="text" id="city" placeholder="city"/>
                <br/>
                <label>Region:</label>
                <input type="text" id="region" placeholder="region"/>
                <br/>
                <label>Country:</label>
                <input type="text" id="country" placeholder="country"/>
                <br/>
                <label>Longitude:</label>
                <input type="number" id="longitude" placeholder="longitude"/>
                <br/>
                <label>Latitude:</label>
                <input type="number" id="latitude" placeholder="latitude"/>
                <br/>
                <button class="pure-button pure-button-primary" id="addLocation">Submit</button>
                <button class="pure-button pure-button-primary" id="displayLocations">Display all locations</button>
            </div>
        </fieldset>
    </form>
    <div id="innerDiv" style="width: 40%; margin: 0 auto">
    </div>
</div>
<div style="text-align: center;">
    <h1>Forecast input data:</h1>
    <form id="forecastForm" class="pure-form pure-form-aligned">
        <fieldset>
            <div class="pure-control-group">
                <label>Location id:</label>
                <input type="number" id="locationId" placeholder="Location id"/>
                <br/>
                <label>Number of days ahead for the forecast:</label>
                <input type="number" id="days" placeholder="Number of days"/>
                <br/>
                <button class="pure-button pure-button-primary" id="getForecast">Submit</button>
                <button class="pure-button pure-button-primary" id="displayForecasts">Display all forecasts</button>
            </div>
        </fieldset>
    </form>
    <div id="innerDivForecast" style="width: 40%; margin: 0 auto">
    </div>
</div>
<script>
    const URL_LOCATION = 'http://localhost:8080/location';
    const innerDiv = document.getElementById('innerDiv');

    document.getElementById('displayLocations').addEventListener('click', (event) => {
        event.preventDefault();
        fetch(URL_LOCATION)
            .then(response => response.json())
            .then((json)=>
            innerDiv.innerHTML=`<p>${JSON.stringify(json)}</p>`
            );
    });

    document.getElementById('addLocation').addEventListener('click', (event) => {
        event.preventDefault();
        fetch(URL_LOCATION, {
            method: "POST",
            body: JSON.stringify({
                city: document.getElementById("city").value,
                region: document.getElementById("region").value,
                country: document.getElementById("country").value,
                longitude: document.getElementById("longitude").value,
                latitude: document.getElementById("latitude").value
            }),
            headers: {
                "Content-type": "application/json; charset=UTF-8"
            }
        })
            .then(response => response.json())
            .then((json)=>
                innerDiv.innerHTML=`<p>${JSON.stringify(json)}</p>`
            );
    });

    const URL_FORECAST = 'http://localhost:8080/forecast';
    const URL_FORECASTS = 'http://localhost:8080/forecasts';
    const innerDiv_forecast = document.getElementById('innerDivForecast');

    document.getElementById('getForecast').addEventListener('click', (event) => {
        event.preventDefault();
        const formObj = {
            id: document.getElementById("locationId").value,
            days: document.getElementById("days").value
        }
        fetch(`${URL_FORECAST}?${new URLSearchParams(formObj)}`)
            .then(response => response.json())
            .then((json)=>
            innerDiv_forecast.innerHTML=`<p>${JSON.stringify(json)}</p>`
            );
    });

    document.getElementById('displayForecasts').addEventListener('click', (event) => {
        event.preventDefault();
        fetch(URL_FORECASTS)
            .then(response => response.json())
            .then((json)=>
            innerDiv_forecast.innerHTML=`<p>${JSON.stringify(json)}</p>`
            );
    });


</script>
</body>
</html>